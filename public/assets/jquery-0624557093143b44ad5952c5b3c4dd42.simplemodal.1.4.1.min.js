/*
 * SimpleModal 1.4.1 - jQuery Plugin
 * http://www.ericmmartin.com/projects/simplemodal/
 * Copyright (c) 2010 Eric Martin (http://twitter.com/ericmmartin)
 * Dual licensed under the MIT and GPL licenses
 * Revision: $Id: jquery.simplemodal.js 261 2010-11-05 21:16:20Z emartin24 $
 */
(function(a){var b=a.browser.msie&&parseInt(a.browser.version)===6&&typeof window.XMLHttpRequest!="object",c=a.browser.msie&&parseInt(a.browser.version)===7,d=null,e=[];a.modal=function(b,c){return a.modal.impl.init(b,c)},a.modal.close=function(){a.modal.impl.close()},a.modal.focus=function(b){a.modal.impl.focus(b)},a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()},a.modal.setPosition=function(){a.modal.impl.setPosition()},a.modal.update=function(b,c){a.modal.impl.update(b,c)},a.fn.modal=function(b){return a.modal.impl.init(this,b)},a.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},a.modal.impl={d:{},init:function(b,c){var e=this;if(e.d.data)return!1;d=a.browser.msie&&!a.boxModel,e.o=a.extend({},a.modal.defaults,c),e.zIndex=e.o.zIndex,e.occb=!1;if(typeof b=="object")b=b instanceof jQuery?b:a(b),e.d.placeholder=!1,b.parent().parent().size()>0&&(b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),e.d.placeholder=!0,e.display=b.css("display"),e.o.persist||(e.d.orig=b.clone(!0)));else if(typeof b=="string"||typeof b=="number")b=a("<div></div>").html(b);else return alert("SimpleModal Error: Unsupported data type: "+typeof b),e;return e.create(b),e.open(),a.isFunction(e.o.onShow)&&e.o.onShow.apply(e,[e.d]),e},create:function(c){var g=this;e=g.getDimensions(),g.o.modal&&b&&(g.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(g.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:e[0],width:e[1],zIndex:g.o.zIndex,top:0,left:0})).appendTo(g.o.appendTo)),g.d.overlay=a("<div></div>").attr("id",g.o.overlayId).addClass("simplemodal-overlay").css(a.extend(g.o.overlayCss,{display:"none",opacity:g.o.opacity/100,height:g.o.modal?e[0]:0,width:g.o.modal?e[1]:0,position:"fixed",left:0,top:0,zIndex:g.o.zIndex+1})).appendTo(g.o.appendTo),g.d.container=a("<div></div>").attr("id",g.o.containerId).addClass("simplemodal-container").css(a.extend(g.o.containerCss,{display:"none",position:"fixed",zIndex:g.o.zIndex+2})).append(g.o.close&&g.o.closeHTML?a(g.o.closeHTML).addClass(g.o.closeClass):"").appendTo(g.o.appendTo),g.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(g.d.container),g.d.data=c.attr("id",c.attr("id")||g.o.dataId).addClass("simplemodal-data").css(a.extend(g.o.dataCss,{display:"none"})).appendTo("body"),g.setContainerDimensions(),g.d.data.appendTo(g.d.wrap),(b||d)&&g.fixIE()},bindEvents:function(){var c=this;a("."+c.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault(),c.close()}),c.o.modal&&c.o.close&&c.o.overlayClose&&c.d.overlay.bind("click.simplemodal",function(a){a.preventDefault(),c.close()}),a(document).bind("keydown.simplemodal",function(a){c.o.modal&&a.keyCode===9?c.watchTab(a):c.o.close&&c.o.escClose&&a.keyCode===27&&(a.preventDefault(),c.close())}),a(window).bind("resize.simplemodal",function(){e=c.getDimensions(),c.o.autoResize?c.setContainerDimensions():c.o.autoPosition&&c.setPosition(),b||d?c.fixIE():c.o.modal&&(c.d.iframe&&c.d.iframe.css({height:e[0],width:e[1]}),c.d.overlay.css({height:e[0],width:e[1]}))})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal"),a(document).unbind("keydown.simplemodal"),a(window).unbind("resize.simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this,c=b.o.position;a.each([b.d.iframe||null,b.o.modal?b.d.overlay:null,b.d.container],function(a,b){if(b){var d=b[0].style;d.position="absolute";if(a<2)d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",'document.body.scrollHeight > document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + "px"'),d.setExpression("width",'document.body.scrollWidth > document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + "px"');else{var e;c&&c.constructor===Array?(a=c[0]?typeof c[0]=="number"?c[0].toString():c[0].replace(/px/,""):b.css("top").replace(/px/,""),a=a.indexOf("%")===-1?a+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"':parseInt(a.replace(/%/,""))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',c[1]&&(e=typeof c[1]=="number"?c[1].toString():c[1].replace(/px/,""),e=e.indexOf("%")===-1?e+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"':parseInt(e.replace(/%/,""))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"')):(a='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',e='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"'),d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",a),d.setExpression("left",e)}}})},focus:function(b){var c=this;b=b&&a.inArray(b,["first","last"])!==-1?b:"first";var d=a(":input:enabled:visible:"+b,c.d.wrap);setTimeout(function(){d.length>0?d.focus():c.d.wrap.focus()},10)},getDimensions:function(){var b=a(window);return[a.browser.opera&&a.browser.version>"9.5"&&a.fn.jquery<"1.3"||a.browser.opera&&a.browser.version<"9.5"&&a.fn.jquery>"1.2.6"?b[0].innerHeight:b.height(),b.width()]},getVal:function(a,b){return a?typeof a=="number"?a:a==="auto"?0:a.indexOf("%")>0?parseInt(a.replace(/%/,""))/100*(b==="h"?e[0]:e[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){var c=this;if(!c.d.data)return!1;c.d.origHeight=c.getVal(a,"h"),c.d.origWidth=c.getVal(b,"w"),c.d.data.hide(),a&&c.d.container.css("height",a),b&&c.d.container.css("width",b),c.setContainerDimensions(),c.d.data.show(),c.o.focus&&c.focus(),c.unbindEvents(),c.bindEvents()},setContainerDimensions:function(){var d=this,g=b||c,h=d.d.origHeight?d.d.origHeight:a.browser.opera?d.d.container.height():d.getVal(g?d.d.container[0].currentStyle.height:d.d.container.css("height"),"h");g=d.d.origWidth?d.d.origWidth:a.browser.opera?d.d.container.width():d.getVal(g?d.d.container[0].currentStyle.width:d.d.container.css("width"),"w");var i=d.d.data.outerHeight(!0),j=d.d.data.outerWidth(!0);d.d.origHeight=d.d.origHeight||h,d.d.origWidth=d.d.origWidth||g;var l=d.o.maxHeight?d.getVal(d.o.maxHeight,"h"):null,n=d.o.maxWidth?d.getVal(d.o.maxWidth,"w"):null;l=l&&l<e[0]?l:e[0],n=n&&n<e[1]?n:e[1];var o=d.o.minHeight?d.getVal(d.o.minHeight,"h"):"auto";h=h?d.o.autoResize&&h>l?l:h<o?o:h:i?i>l?l:d.o.minHeight&&o!=="auto"&&i<o?o:i:o,l=d.o.minWidth?d.getVal(d.o.minWidth,"w"):"auto",g=g?d.o.autoResize&&g>n?n:g<l?l:g:j?j>n?n:d.o.minWidth&&l!=="auto"&&j<l?l:j:l,d.d.container.css({height:h,width:g}),d.d.wrap.css({overflow:i>h||j>g?"auto":"visible"}),d.o.autoPosition&&d.setPosition()},setPosition:function(){var a=this,b,c;b=e[0]/2-a.d.container.outerHeight(!0)/2,c=e[1]/2-a.d.container.outerWidth(!0)/2,a.o.position&&Object.prototype.toString.call(a.o.position)==="[object Array]"?(b=a.o.position[0]||b,c=a.o.position[1]||c):(b=b,c=c),a.d.container.css({left:c,top:b})},watchTab:function(b){var c=this;if(a(b.target).parents(".simplemodal-container").length>0){c.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",c.d.data[0]);if(!b.shiftKey&&b.target===c.inputs[c.inputs.length-1]||b.shiftKey&&b.target===c.inputs[0]||c.inputs.length===0)b.preventDefault(),c.focus(b.shiftKey?"last":"first")}else b.preventDefault(),c.focus()},open:function(){var b=this;b.d.iframe&&b.d.iframe.show(),a.isFunction(b.o.onOpen)?b.o.onOpen.apply(b,[b.d]):(b.d.overlay.show(),b.d.container.show(),b.d.data.show()),b.o.focus&&b.focus(),b.bindEvents()},close:function(){var b=this;if(!b.d.data)return!1;b.unbindEvents();if(a.isFunction(b.o.onClose)&&!b.occb)b.occb=!0,b.o.onClose.apply(b,[b.d]);else{if(b.d.placeholder){var c=a("#simplemodal-placeholder");b.o.persist?c.replaceWith(b.d.data.removeClass("simplemodal-data").css("display",b.display)):(b.d.data.hide().remove(),c.replaceWith(b.d.orig))}else b.d.data.hide().remove();b.d.container.hide().remove(),b.d.overlay.hide(),b.d.iframe&&b.d.iframe.hide().remove(),setTimeout(function(){b.d.overlay.remove(),b.d={}},10)}}}})(jQuery)